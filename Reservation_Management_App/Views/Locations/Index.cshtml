@model IEnumerable<Reservation_Management_App.Domain.DomainModels.Location>
@{
    ViewData["Title"] = "Locations";
}

<!-- Page Header -->
<div class="page-header mb-4">
    <div class="d-flex justify-content-between align-items-center">
        <div>
            <h1>
                <i class="bi bi-geo-alt" style="color: #f97316;"></i> Locations
            </h1>
            <p style="color: #a0a0a0;">Manage venues and locations</p>
        </div>
        <a class="btn btn-primary" asp-action="Create">
            <i class="bi bi-plus-lg me-2"></i>Add Location
        </a>
    </div>
</div>

@if (TempData["Success"] != null)
{
    <div class="alert alert-success mb-4">
        <i class="bi bi-check-circle me-2"></i>@TempData["Success"]
    </div>
}

@if (TempData["Error"] != null)
{
    <div class="alert alert-danger mb-4">
        <i class="bi bi-exclamation-triangle me-2"></i>@TempData["Error"]
    </div>
}

@if (!Model.Any())
{
    <div class="alert alert-info">
        <i class="bi bi-info-circle me-2"></i>No locations yet. Add one to get started.
    </div>
}
else
{
    <!-- Locations Table -->
    <div class="card">
        <div class="table-responsive">
            <table class="table table-hover mb-0">
                <thead>
                    <tr>
                        <th>Venue</th>
                        <th>Address</th>
                        <th>Phone</th>
                        <th>Type</th>
                        <th>Capacity</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var location in Model)
                    {
                        var img = string.IsNullOrWhiteSpace(location.ImageUrl)
                        ? "https://images.unsplash.com/photo-1470229722913-7c0e2dbbafd3?w=100&h=100&fit=crop"
                        : location.ImageUrl;

                        // Use actual Type and Capacity from database
                        var venueType = location.Type ?? "Venue";
                        var capacity = location.Capacity?.ToString() ?? "-";

                        var badgeClass = venueType == "Club" ? "badge-purple" :
                        venueType == "Concert Hall" ? "badge-pink" :
                        venueType == "Bar" || venueType == "Lounge" ? "badge-violet" : "badge-gray";

                        <tr>
                            <td>
                                <div class="d-flex align-items-center gap-3">
                                    <img src="@img" alt="@location.Name"
                                         style="width: 60px; height: 60px; object-fit: cover; border-radius: 8px;" />
                                    <div>
                                        <div style="font-weight: 600; color: white;">
                                            @location.Name
                                            @if (location.ImportedFromApi)
                                            {
                                                <span class="badge ms-2" style="background: rgba(99, 102, 241, 0.2); color: #6366f1; font-size: 0.7rem; padding: 0.3rem 0.6rem;">
                                                    <i class="bi bi-cloud-download me-1"></i>From API
                                                </span>
                                            }
                                        </div>
                                    </div>
                                </div>
                            </td>
                            <td style="vertical-align: middle; color: #a0a0a0;">
                                @if (!string.IsNullOrWhiteSpace(location.Address))
                                {
                                    @location.Address
                                }
                                else
                                {
                                    <span style="color: #6b7280;">-</span>
                                }
                            </td>

                            <td style="vertical-align: middle;">
                                @if (!string.IsNullOrWhiteSpace(location.PhoneNumber))
                                {
                                    <div class="d-flex align-items-center gap-2">
                                        <i class="bi bi-telephone-fill" style="color: #10b981; font-size: 0.9rem;"></i>
                                        <span style="color: #a0a0a0;">@location.PhoneNumber</span>
                                    </div>
                                }
                                else
                                {
                                    <span style="color: #6b7280;">-</span>
                                }
                            </td>

                            <td style="vertical-align: middle;">
                                <span class="badge @badgeClass">@venueType</span>
                            </td>
                            <td style="vertical-align: middle; color: white; font-weight: 600;">
                                @capacity
                            </td>
                            <td style="vertical-align: middle;">
                                <div class="d-flex gap-2">
                                    <a asp-action="Edit" asp-route-id="@location.Id" class="btn btn-sm btn-link p-1" style="color: #d946ef;">
                                        <i class="bi bi-pencil" style="font-size: 1.1rem;"></i>
                                    </a>
                                    <a asp-action="Delete" asp-route-id="@location.Id" class="btn btn-sm btn-link p-1" style="color: #ef4444;">
                                        <i class="bi bi-trash" style="font-size: 1.1rem;"></i>
                                    </a>
                                </div>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
}

<style>
    .badge-purple {
        background: #d946ef;
        color: white;
        padding: 0.4rem 0.8rem;
        border-radius: 6px;
        font-weight: 600;
        font-size: 0.75rem;
    }

    .badge-pink {
        background: #ec4899;
        color: white;
        padding: 0.4rem 0.8rem;
        border-radius: 6px;
        font-weight: 600;
        font-size: 0.75rem;
    }

    .badge-violet {
        background: #8b5cf6;
        color: white;
        padding: 0.4rem 0.8rem;
        border-radius: 6px;
        font-weight: 600;
        font-size: 0.75rem;
    }

    .badge-gray {
        background: #6b7280;
        color: white;
        padding: 0.4rem 0.8rem;
        border-radius: 6px;
        font-weight: 600;
        font-size: 0.75rem;
    }
</style>